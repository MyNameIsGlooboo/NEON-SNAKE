<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Snake Game</title>
    <style>
        @media (max-width: 767px) {
            .game-container {
                padding: 15px;
                width: 100%;
                max-width: 100%;
                margin: 0;
                border-radius: 0;
                height: auto;
                min-height: 100vh;
                gap: 10px;
            }
            
            #game-board {
                max-width: 100% !important;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .score-container {
                font-size: 1rem;
            }
            
            .controls button {
                padding: 8px 15px;
                font-size: 1rem;
            }
            
            .touch-controls {
                width: 80%;
                max-width: 250px;
                height: auto;
                aspect-ratio: 2/1;
            }
            
            .touch-controls button {
                font-size: 1.5rem;
            }
            
            #welcome-screen h2 {
                font-size: 2rem;
            }
            
            #welcome-screen p, #welcome-screen ul {
                font-size: 1.2rem;
            }
            
            #welcome-screen {
                padding: 5px;
            }
            
            #welcome-screen ul {
                max-width: 90%;
            }
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .game-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            padding: 30px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(0, 150, 255, 0.5);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 150, 255, 0.3);
            width: 90%;
            max-width: 500px;
            margin: 0 auto;
        }
        
        h1 {
            color: #00d9ff;
            text-shadow: 0 0 10px rgba(0, 217, 255, 0.7);
            font-size: 2.5rem;
            letter-spacing: 3px;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .score-container {
            display: flex;
            justify-content: space-between;
            width: 100%;
            color: white;
            font-size: 1.2rem;
        }
        
        #score {
            color: #00ffaa;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0, 255, 170, 0.7);
        }
        
        #game-board {
            border: 2px solid rgba(0, 150, 255, 0.5);
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 100, 255, 0.3);
            background: rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
            aspect-ratio: 1/1;
        }
        
        .touch-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 10px;
            width: 250px;
            height: 150px;
            margin: 30px auto 0;
        }
        
        .touch-controls button {
            padding: 0;
            background: rgba(0, 150, 255, 0.3);
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 0 10px rgba(0, 150, 255, 0.5);
        }
        
        .touch-controls button:active {
            background: rgba(0, 217, 255, 0.7);
            transform: scale(0.95);
        }
        
        #up-btn {
            grid-column: 2;
            grid-row: 1;
        }
        
        #left-btn {
            grid-column: 1;
            grid-row: 2;
        }
        
        #right-btn {
            grid-column: 3;
            grid-row: 2;
        }
        
        #down-btn {
            grid-column: 2;
            grid-row: 2;
            font-size: 2.4rem;
        }
        
        @media (min-width: 768px) {
            .touch-controls {
                display: none;
            }
        }
        
        .controls {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }
        
        button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #00d9ff 0%, #0080ff 100%);
            border: none;
            border-radius: 50px;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(0, 150, 255, 0.5);
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 20px rgba(0, 150, 255, 0.8);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        #welcome-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 1.5rem;
            text-align: center;
            border-radius: 20px;
            z-index: 20;
            padding: 20px;
        }
        
        #welcome-screen h2 {
            color: #00d9ff;
            text-shadow: 0 0 10px rgba(0, 217, 255, 0.7);
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        #welcome-screen p {
            margin: 10px 0;
            max-width: 80%;
        }
        
        #welcome-screen ul {
            text-align: left;
            margin: 15px 0;
            padding-left: 20px;
            max-width: 80%;
        }
        
        #welcome-screen li {
            margin: 8px 0;
        }
        
        #start-welcome-btn {
            margin-top: 20px;
            background: linear-gradient(135deg, #00d9ff 0%, #0080ff 100%);
            box-shadow: 0 0 20px rgba(0, 150, 255, 0.5);
        }
        
        #game-over, #game-paused {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 2.5rem;
            text-align: center;
            border-radius: 20px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
            z-index: 10;
        }
        
        #game-over.show, #game-paused.show {
            opacity: 1;
            pointer-events: all;
        }
        
        #welcome-screen {
            display: flex;
        }
        
        #restart-btn {
            margin-top: 20px;
            background: linear-gradient(135deg, #ff00cc 0%, #ff0066 100%);
            box-shadow: 0 0 20px rgba(255, 0, 204, 0.5);
        }
        
        #final-score {
            color: #ff00aa;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 0, 170, 0.7);
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div id="welcome-screen">
            <h2>WELCOME TO NEON SNAKE</h2>
            <p>Guide the neon snake to eat the glowing food!</p>
            <ul>
                <li>Use <span style="color:#00ffaa">ARROW KEYS</span> or <span style="color:#00ffaa">TOUCH CONTROLS</span> to move</li>
                <li>Don't hit walls or yourself</li>
                <li>Each food gives <span style="color:#ff00aa">10 points</span></li>
            </ul>
            <p>Press START to begin your neon adventure!</p>
            <button id="start-welcome-btn">START GAME</button>
        </div>
        <h1>NEON SNAKE</h1>
        <div class="score-container">
            <div>SCORE: <span id="score">0</span></div>
            <div>HIGH SCORE: <span id="high-score">0</span></div>
        </div>
        <canvas id="game-board"></canvas>
        <div class="controls">
            <button id="start-btn">START</button>
            <button id="pause-btn">PAUSE</button>
        </div>
        <div class="touch-controls">
            <button id="up-btn">↑</button>
            <button id="left-btn">←</button>
            <button id="right-btn">→</button>
            <button id="down-btn">↓</button>
        </div>
        <div id="game-over">
            <div>GAME OVER!</div>
            <div>Your score: <span id="final-score">0</span></div>
            <button id="restart-btn">PLAY AGAIN</button>
        </div>
        <div id="game-paused">
            <div>GAME PAUSED</div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('game-board');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const highScoreElement = document.getElementById('high-score');
        const finalScoreElement = document.getElementById('final-score');
        const startButton = document.getElementById('start-btn');
        const pauseButton = document.getElementById('pause-btn');
        const restartButton = document.getElementById('restart-btn');
        const gameOverScreen = document.getElementById('game-over');
        const upButton = document.getElementById('up-btn');
        const leftButton = document.getElementById('left-btn');
        const rightButton = document.getElementById('right-btn');
        const downButton = document.getElementById('down-btn');
        const welcomeScreen = document.getElementById('welcome-screen');
        const startWelcomeButton = document.getElementById('start-welcome-btn');
        
        let gridSize;
        const tileCount = 20; // Reduced for 50% bigger tiles
        let canvasSize;
        
        let snake = [];
        let food = {};
        let dx = 0;
        let dy = 0;
        let directionQueue = [];
        let score = 0;
        let highScore = 0;
        let gameSpeed = 84; // 30% faster (120 * 0.7 = 84)
        let gameRunning = false;
        let gamePaused = false;
        let gameLoop;
        
        // Initialize game
        function initGame() {
            // Set canvas size based on container
            canvasSize = Math.min(canvas.parentElement.clientWidth, 400);
            canvas.width = canvasSize;
            canvas.height = canvasSize;
            gridSize = canvasSize / tileCount;
            
            snake = [
                {x: 10, y: 10}, // Adjusted for new grid size (20 tiles)
                {x: 9, y: 10},
                {x: 8, y: 10}
            ];
            
            generateFood();
            score = 0;
            dx = 1;
            dy = 0;
            gameSpeed = 120; // Reset game speed to initial value
            updateScore();
        }
        
        // Generate food at random position
        function generateFood() {
            food = {
                x: Math.floor(Math.random() * tileCount),
                y: Math.floor(Math.random() * tileCount)
            };
            
            // Make sure food doesn't appear on snake
            for (let segment of snake) {
                if (segment.x === food.x && segment.y === food.y) {
                    return generateFood();
                }
            }
        }
        
        // Update score display
        function updateScore() {
            scoreElement.textContent = score;
            if (score > highScore) {
                highScore = score;
                highScoreElement.textContent = highScore;
                // Save new high score to cookie
                const d = new Date();
                d.setFullYear(d.getFullYear() + 1);
                document.cookie = `high_score=${highScore}; expires=${d.toUTCString()}; path=/`;
            }
        }
        
        // Draw game elements
        function draw() {
            // Clear canvas
            ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw snake
            snake.forEach((segment, index) => {
                if (index === 0) {
                    // Head
                    ctx.fillStyle = '#00ffaa';
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = '#00ffaa';
                } else if (index === snake.length - 1) {
                    // Tail - no shadow and different color
                    ctx.fillStyle = '#00aaff';
                    ctx.shadowBlur = 0;
                } else {
                    // Body
                    ctx.fillStyle = '#00d9ff';
                    ctx.shadowBlur = 5;
                    ctx.shadowColor = '#00d9ff';
                }
                
                ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize, gridSize);
                ctx.strokeStyle = 'rgba(0, 0, 30, 0.5)';
                ctx.strokeRect(segment.x * gridSize, segment.y * gridSize, gridSize, gridSize);
            });
            
            // Draw food
            ctx.fillStyle = '#ff0066';
            ctx.shadowBlur = 15;
            ctx.shadowColor = '#ff0066';
            ctx.beginPath();
            ctx.arc(
                food.x * gridSize + gridSize/2, 
                food.y * gridSize + gridSize/2, 
                gridSize/2, 
                0, 
                Math.PI * 2
            );
            ctx.fill();
        }
        
        // Move snake
        function move() {
            // Process direction queue
            while (directionQueue.length > 0) {
                const nextDir = directionQueue.shift();
                // Only allow 90-degree turns
                if (dx !== -nextDir.dx || dy !== -nextDir.dy) {
                    dx = nextDir.dx;
                    dy = nextDir.dy;
                    break; // only process one direction change per frame
                }
            }
            
            // Create new head
            const head = {x: snake[0].x + dx, y: snake[0].y + dy};
            
            // Game over conditions
            if (
                head.x < 0 || 
                head.y < 0 || 
                head.x >= tileCount || 
                head.y >= tileCount ||
                snake.some(segment => segment.x === head.x && segment.y === head.y)
            ) {
                endGame();
                return;
            }
            
            // Add new head
            snake.unshift(head);
            
            // Check if food is eaten
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                updateScore();
                generateFood();
                
                // Increase speed slightly
                if (gameSpeed > 70) {
                    gameSpeed -= 2;
                    // Restart the game loop with the new speed
                    clearInterval(gameLoop);
                    gameLoop = setInterval(gameStep, gameSpeed);
                }
            } else {
                // Remove tail
                snake.pop();
            }
        }
        
        // Main game loop
        function gameStep() {
            if (gameRunning && !gamePaused) {
                move();
                draw();
            }
        }
        
        // Start game
        
        // Pause game
        function pauseGame() {
            if (gameRunning) {
                gamePaused = !gamePaused;
                pauseButton.textContent = gamePaused ? 'RESUME' : 'PAUSE';
                const pausedScreen = document.getElementById('game-paused');
                if (gamePaused) {
                    pausedScreen.classList.add('show');
                } else {
                    pausedScreen.classList.remove('show');
                }
            }
        }
        
        // End game
        function endGame() {
            gameRunning = false;
            clearInterval(gameLoop);
            finalScoreElement.textContent = score;
            gameOverScreen.classList.add('show');
        }
        
        // Handle keyboard input
        function handleKeyPress(e) {
            // Prevent arrow keys from scrolling page
            if ([37, 38, 39, 40].includes(e.keyCode)) {
                e.preventDefault();
            }
            
            // Left arrow
            if (e.keyCode === 37 && dx !== 1) {
                directionQueue.push({ dx: -1, dy: 0 });
            }
            // Up arrow
            else if (e.keyCode === 38 && dy !== 1) {
                directionQueue.push({ dx: 0, dy: -1 });
            }
            // Right arrow
            else if (e.keyCode === 39 && dx !== -1) {
                directionQueue.push({ dx: 1, dy: 0 });
            }
            // Down arrow
            else if (e.keyCode === 40 && dy !== -1) {
                directionQueue.push({ dx: 0, dy: 1 });
            }
            // Space bar to pause
            else if (e.keyCode === 32) {
                pauseGame();
            }
        }
        
        // Touch controls
        function goUp() {
            if (dy !== 1) {
                directionQueue.push({ dx: 0, dy: -1 });
            }
        }
        
        function goLeft() {
            if (dx !== 1) {
                directionQueue.push({ dx: -1, dy: 0 });
            }
        }
        
        function goRight() {
            if (dx !== -1) {
                directionQueue.push({ dx: 1, dy: 0 });
            }
        }
        
        function goDown() {
            if (dy !== -1) {
                directionQueue.push({ dx: 0, dy: 1 });
            }
        }
        
        // Swipe controls
        let touchStartX = 0;
        let touchStartY = 0;
        
        function handleTouchStart(e) {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }
        
        function handleTouchMove(e) {
            if (!touchStartX || !touchStartY) return;
            
            const touchEndX = e.changedTouches[0].screenX;
            const touchEndY = e.changedTouches[0].screenY;
            
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;
            
            // Only consider it a swipe if the movement is significant
            if (Math.max(Math.abs(diffX), Math.abs(diffY)) < 20) return;
            
            if (Math.abs(diffX) > Math.abs(diffY)) {
                // Horizontal swipe
                if (diffX > 0 && dx !== 1) {
                    // Swipe left
                    directionQueue.push({ dx: -1, dy: 0 });
                } else if (diffX < 0 && dx !== -1) {
                    // Swipe right
                    directionQueue.push({ dx: 1, dy: 0 });
                }
            } else {
                // Vertical swipe
                if (diffY > 0 && dy !== 1) {
                    // Swipe up
                    directionQueue.push({ dx: 0, dy: -1 });
                } else if (diffY < 0 && dy !== -1) {
                    // Swipe down
                    directionQueue.push({ dx: 0, dy: 1 });
                }
            }
            
            touchStartX = 0;
            touchStartY = 0;
        }
        
        // Event listeners
        startButton.addEventListener('click', startGame);
        pauseButton.addEventListener('click', pauseGame);
        restartButton.addEventListener('click', startGame);
        startWelcomeButton.addEventListener('click', startGame);
        upButton.addEventListener('click', goUp);
        leftButton.addEventListener('click', goLeft);
        rightButton.addEventListener('click', goRight);
        downButton.addEventListener('click', goDown);
        document.addEventListener('keydown', handleKeyPress);
        canvas.addEventListener('touchstart', handleTouchStart);
        canvas.addEventListener('touchmove', handleTouchMove);
        
        // Function to get cookie by name
        function getCookie(name) {
            const cookies = document.cookie.split(';');
            for (let cookie of cookies) {
                const [cookieName, cookieValue] = cookie.trim().split('=');
                if (cookieName === name) {
                    return parseInt(cookieValue);
                }
            }
            return 0;
        }
        
        // Get initial high score from cookie
        highScore = getCookie('high_score');
        highScoreElement.textContent = highScore;
        
        // Initial setup
        initGame();
        window.addEventListener('resize', initGame);
        
        // Hide welcome screen when game starts
        function startGame() {
            if (!gameRunning) {
                welcomeScreen.style.display = 'none';
                initGame();
                gameRunning = true;
                gamePaused = false;
                // Clear any existing game loop
                if (gameLoop) {
                    clearInterval(gameLoop);
                }
                gameLoop = setInterval(gameStep, gameSpeed);
                gameOverScreen.classList.remove('show');
                // Also hide pause screen if visible
                document.getElementById('game-paused').classList.remove('show');
            }
        }
    </script>
</body>
</html>
